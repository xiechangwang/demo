<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<script src="https://cdn.bootcss.com/vue/2.5.20/vue.min.js"></script>
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>
	<body>
		<div id="app">
			<el-upload 
				class="upload-demo" 
				action="https://jsonplaceholder.typicode.com/posts/" 
				:on-change="change"
				:before-upload="beforeUp"
				multiple 
				:file-list="fileList"
				ref="upload"
				>
				<el-button size="small" type="primary">点击上传</el-button>
				<div slot="tip" class="el-upload__tip">只能上传jpg/png文件，且不超过500kb</div>
			</el-upload>
		</div>
	</body>
	<script type="text/javascript">
		new Vue({
			el: '#app',
			data: {
				fileList: [],
				upFileList:null
			},
			methods: {
				beforeUp(file){
					let that=this;
					const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';
					if(!isJPG){
						this.$message.error('上传头像图片只能是 img 格式!');
						// console.log('22222m')
						that.$nextTick(()=>{
							console.log(that.upFileList);
							that.upFileList.forEach((item)=>{
									that.$refs.upload.abort(item);
									that.$refs.upload.clearFiles();
							});
						})
						return false
					}
				},
				change(file,fileList){
					// console.log('49',fileList);
					this.upFileList=fileList
				}
			}
		})
	</script>
</html>
